{"version":3,"file":"viewer.min.js","sources":["../src/viewer.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * GEAR Viewer - Main JavaScript module for 3D/AR/VR viewing.\n *\n * @module     mod_gear/viewer\n * @copyright  2026 Boban Blagojevic\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/* global THREE */\n\ndefine(['jquery', 'core/ajax', 'core/notification', 'core/str'], function($, Ajax, Notification, Str) {\n    'use strict';\n\n    /**\n     * GEAR Viewer class.\n     */\n    class GearViewer {\n        /**\n         * Constructor.\n         *\n         * @param {Object} options Configuration options\n         */\n        constructor(options) {\n            this.cmid = options.cmid;\n            this.gearid = options.gearid;\n            this.config = options.config || {};\n            this.arEnabled = options.ar_enabled || false;\n            this.vrEnabled = options.vr_enabled || false;\n            this.modelsData = options.models || [];\n\n            this.container = document.getElementById('gear-viewer-' + this.cmid);\n            this.canvas = document.getElementById('gear-canvas-' + this.cmid);\n\n            this.isFullscreen = false;\n            this.isAutoRotating = false;\n            this.scene = null;\n            this.camera = null;\n            this.renderer = null;\n            this.controls = null;\n            this.model = null;\n\n            this.init();\n        }\n\n        /**\n         * Initialize the viewer.\n         */\n        async init() {\n            try {\n                await this.loadThreeJS();\n                this.setupScene();\n                this.setupControls();\n                this.setupEventListeners();\n                this.loadModels();\n                this.animate();\n\n                // Dispatch loaded event.\n                var eventDetail = {cmid: this.cmid, gearid: this.gearid};\n                document.dispatchEvent(new CustomEvent('gear:scene:loaded', {detail: eventDetail}));\n            } catch (error) {\n                Notification.exception(error);\n            }\n        }\n\n        /**\n         * Load Three.js library.\n         * Three.js is loaded by PHP before AMD, so just verify it exists.\n         */\n        async loadThreeJS() {\n            // Three.js is loaded via PHP $PAGE->requires->js() before this module.\n            // Just wait for it to be available.\n            if (typeof THREE === 'undefined') {\n                // Wait a bit for scripts to load.\n                await new Promise(resolve => setTimeout(resolve, 500));\n            }\n            if (typeof THREE === 'undefined') {\n                throw new Error('Three.js not loaded. Please check view.php.');\n            }\n        }\n\n        /**\n         * Setup the Three.js scene.\n         */\n        setupScene() {\n            var bgColor;\n            var aspect;\n            var camPos;\n\n            // Create scene.\n            this.scene = new THREE.Scene();\n\n            // Set background color.\n            bgColor = this.config.background || '#1a1a2e';\n            this.scene.background = new THREE.Color(bgColor);\n\n            // Create camera.\n            aspect = this.container.clientWidth / this.container.clientHeight;\n            this.camera = new THREE.PerspectiveCamera(75, aspect, 0.1, 1000);\n            camPos = this.config.camera?.position || [0, 1.6, 3];\n            this.camera.position.set(camPos[0], camPos[1], camPos[2]);\n\n            // Create renderer.\n            this.renderer = new THREE.WebGLRenderer({\n                canvas: this.canvas,\n                antialias: true,\n                alpha: true\n            });\n            this.renderer.setSize(this.container.clientWidth, this.container.clientHeight);\n            this.renderer.setPixelRatio(window.devicePixelRatio);\n            this.renderer.outputEncoding = THREE.sRGBEncoding;\n            this.renderer.xr.enabled = true;\n\n            // Add lighting.\n            this.setupLighting();\n\n            // Add resize handler.\n            window.addEventListener('resize', () => this.onResize());\n        }\n\n        /**\n         * Setup scene lighting.\n         */\n        setupLighting() {\n            var preset = this.config.lighting || 'studio';\n            var ambient;\n            var keyLight;\n            var fillLight;\n            var rimLight;\n            var sunLight;\n            var skyLight;\n            var spotLight;\n\n            // Ambient light.\n            ambient = new THREE.AmbientLight(0xffffff, 0.5);\n            this.scene.add(ambient);\n\n            switch (preset) {\n                case 'studio':\n                    // Key light.\n                    keyLight = new THREE.DirectionalLight(0xffffff, 1);\n                    keyLight.position.set(5, 5, 5);\n                    this.scene.add(keyLight);\n\n                    // Fill light.\n                    fillLight = new THREE.DirectionalLight(0xffffff, 0.5);\n                    fillLight.position.set(-5, 0, 5);\n                    this.scene.add(fillLight);\n\n                    // Rim light.\n                    rimLight = new THREE.DirectionalLight(0xffffff, 0.3);\n                    rimLight.position.set(0, 5, -5);\n                    this.scene.add(rimLight);\n                    break;\n\n                case 'outdoor':\n                    sunLight = new THREE.DirectionalLight(0xffffcc, 1.2);\n                    sunLight.position.set(10, 10, 5);\n                    this.scene.add(sunLight);\n\n                    skyLight = new THREE.HemisphereLight(0x87ceeb, 0x3d5c5c, 0.6);\n                    this.scene.add(skyLight);\n                    break;\n\n                case 'dark':\n                    spotLight = new THREE.SpotLight(0xffffff, 0.8);\n                    spotLight.position.set(0, 5, 0);\n                    this.scene.add(spotLight);\n                    break;\n            }\n        }\n\n        /**\n         * Setup orbit controls.\n         */\n        setupControls() {\n            this.controls = new THREE.OrbitControls(this.camera, this.canvas);\n            this.controls.enableDamping = true;\n            this.controls.dampingFactor = 0.05;\n            this.controls.screenSpacePanning = false;\n            this.controls.minDistance = 0.5;\n            this.controls.maxDistance = 50;\n            this.controls.maxPolarAngle = Math.PI;\n        }\n\n        /**\n         * Setup UI event listeners.\n         */\n        setupEventListeners() {\n            var fullscreenBtn;\n            var autorotateBtn;\n            var arBtn;\n            var vrBtn;\n\n            // Fullscreen button.\n            fullscreenBtn = document.getElementById('gear-fullscreen-' + this.cmid);\n            if (fullscreenBtn) {\n                fullscreenBtn.addEventListener('click', () => this.toggleFullscreen());\n            }\n\n            // Auto-rotate button.\n            autorotateBtn = document.getElementById('gear-autorotate-' + this.cmid);\n            if (autorotateBtn) {\n                autorotateBtn.addEventListener('click', () => this.toggleAutoRotate());\n            }\n\n            // AR button.\n            arBtn = document.getElementById('gear-ar-' + this.cmid);\n            if (arBtn && this.arEnabled) {\n                this.setupARButton(arBtn);\n            }\n\n            // VR button.\n            vrBtn = document.getElementById('gear-vr-' + this.cmid);\n            if (vrBtn && this.vrEnabled) {\n                this.setupVRButton(vrBtn);\n            }\n        }\n\n        /**\n         * Setup AR button with WebXR check.\n         *\n         * @param {HTMLElement} button AR button element\n         */\n        async setupARButton(button) {\n            var supported;\n            if ('xr' in navigator) {\n                supported = await navigator.xr.isSessionSupported('immersive-ar');\n                if (!supported) {\n                    button.disabled = true;\n                    button.title = await Str.get_string('arnotsupported', 'mod_gear');\n                } else {\n                    button.addEventListener('click', () => this.startARSession());\n                }\n            } else {\n                button.disabled = true;\n            }\n        }\n\n        /**\n         * Setup VR button with WebXR check.\n         *\n         * @param {HTMLElement} button VR button element\n         */\n        async setupVRButton(button) {\n            var supported;\n            if ('xr' in navigator) {\n                supported = await navigator.xr.isSessionSupported('immersive-vr');\n                if (!supported) {\n                    button.disabled = true;\n                    button.title = await Str.get_string('webxrnotsupported', 'mod_gear');\n                } else {\n                    button.addEventListener('click', () => this.startVRSession());\n                }\n            } else {\n                button.disabled = true;\n            }\n        }\n\n        /**\n         * Load 3D models from config data.\n         */\n        async loadModels() {\n            var loader;\n            var gltf;\n\n            try {\n                if (this.modelsData && this.modelsData.length > 0) {\n                    loader = new THREE.GLTFLoader();\n\n                    for (const modelData of this.modelsData) {\n                        gltf = await new Promise((resolve, reject) => {\n                            loader.load(modelData.url, resolve, undefined, reject);\n                        });\n\n                        this.model = gltf.scene;\n\n                        // Apply default scale.\n                        this.model.scale.setScalar(1);\n\n                        this.scene.add(this.model);\n\n                        // Center camera on model.\n                        this.centerCameraOnModel(this.model);\n                    }\n\n                    // Mark as loaded.\n                    this.container.classList.add('loaded');\n                } else {\n                    // No models uploaded yet - show placeholder.\n                    this.addPlaceholderModel();\n                    this.container.classList.add('loaded');\n                }\n            } catch (error) {\n                // Error loading model - show placeholder.\n                window.console.error('GEAR: Error loading model:', error);\n                this.addPlaceholderModel();\n                this.container.classList.add('loaded');\n            }\n        }\n\n        /**\n         * Add a placeholder model for testing.\n         */\n        addPlaceholderModel() {\n            var geometry = new THREE.BoxGeometry(1, 1, 1);\n            var material = new THREE.MeshStandardMaterial({\n                color: 0x4a90d9,\n                metalness: 0.3,\n                roughness: 0.4\n            });\n            this.model = new THREE.Mesh(geometry, material);\n            this.scene.add(this.model);\n        }\n\n        /**\n         * Center camera on loaded model.\n         *\n         * @param {Object} model The model to center on\n         */\n        centerCameraOnModel(model) {\n            var box = new THREE.Box3().setFromObject(model);\n            var center = box.getCenter(new THREE.Vector3());\n            var size = box.getSize(new THREE.Vector3());\n\n            var maxDim = Math.max(size.x, size.y, size.z);\n            var fov = this.camera.fov * (Math.PI / 180);\n            var cameraZ = Math.abs(maxDim / 2 / Math.tan(fov / 2));\n            cameraZ *= 1.5; // Add some padding.\n\n            this.camera.position.set(center.x, center.y, center.z + cameraZ);\n            this.controls.target.copy(center);\n            this.controls.update();\n        }\n\n        /**\n         * Animation loop.\n         */\n        animate() {\n            this.renderer.setAnimationLoop(() => {\n                if (this.isAutoRotating && this.model) {\n                    this.model.rotation.y += 0.005;\n                }\n\n                this.controls.update();\n                this.renderer.render(this.scene, this.camera);\n            });\n        }\n\n        /**\n         * Handle window resize.\n         */\n        onResize() {\n            var width = this.container.clientWidth;\n            var height = this.container.clientHeight;\n\n            this.camera.aspect = width / height;\n            this.camera.updateProjectionMatrix();\n            this.renderer.setSize(width, height);\n        }\n\n        /**\n         * Toggle fullscreen mode.\n         */\n        toggleFullscreen() {\n            var container = this.container.closest('.gear-viewer-container');\n            var btn;\n            var icon;\n\n            container.classList.toggle('fullscreen');\n            this.isFullscreen = !this.isFullscreen;\n\n            btn = document.getElementById('gear-fullscreen-' + this.cmid);\n            icon = btn.querySelector('i');\n            icon.classList.toggle('fa-expand', !this.isFullscreen);\n            icon.classList.toggle('fa-compress', this.isFullscreen);\n\n            setTimeout(() => this.onResize(), 100);\n        }\n\n        /**\n         * Toggle auto-rotation.\n         */\n        toggleAutoRotate() {\n            var btn;\n\n            this.isAutoRotating = !this.isAutoRotating;\n\n            btn = document.getElementById('gear-autorotate-' + this.cmid);\n            btn.classList.toggle('active', this.isAutoRotating);\n        }\n\n        /**\n         * Start AR session.\n         */\n        async startARSession() {\n            var session;\n            var eventDetail;\n\n            try {\n                session = await navigator.xr.requestSession('immersive-ar', {\n                    requiredFeatures: ['hit-test', 'local-floor']\n                });\n\n                this.renderer.xr.setSession(session);\n\n                eventDetail = {cmid: this.cmid};\n                document.dispatchEvent(new CustomEvent('gear:ar:started', {detail: eventDetail}));\n\n                this.trackEvent('ar_start');\n            } catch (error) {\n                Notification.exception(error);\n            }\n        }\n\n        /**\n         * Start VR session.\n         */\n        async startVRSession() {\n            var session;\n            var eventDetail;\n\n            try {\n                session = await navigator.xr.requestSession('immersive-vr', {\n                    optionalFeatures: ['local-floor', 'bounded-floor']\n                });\n\n                this.renderer.xr.setSession(session);\n\n                eventDetail = {cmid: this.cmid};\n                document.dispatchEvent(new CustomEvent('gear:vr:started', {detail: eventDetail}));\n\n                this.trackEvent('vr_start');\n            } catch (error) {\n                Notification.exception(error);\n            }\n        }\n\n        /**\n         * Track user events.\n         *\n         * @param {string} action Action name\n         * @param {Object} data Additional data\n         */\n        trackEvent(action, data = {}) {\n            Ajax.call([{\n                methodname: 'mod_gear_track_event',\n                args: {\n                    gearid: this.gearid,\n                    action: action,\n                    data: JSON.stringify(data)\n                }\n            }]);\n        }\n    }\n\n    return {\n        /**\n         * Initialize the GEAR viewer.\n         *\n         * @param {Object} options Configuration options\n         */\n        init: function(options) {\n            new GearViewer(options);\n        }\n    };\n});\n"],"names":["define","$","Ajax","Notification","Str","GearViewer","constructor","options","cmid","gearid","config","arEnabled","ar_enabled","vrEnabled","vr_enabled","modelsData","models","container","document","getElementById","this","canvas","isFullscreen","isAutoRotating","scene","camera","renderer","controls","model","init","loadThreeJS","setupScene","setupControls","setupEventListeners","loadModels","animate","eventDetail","dispatchEvent","CustomEvent","detail","error","exception","THREE","Promise","resolve","setTimeout","Error","bgColor","aspect","camPos","Scene","background","Color","clientWidth","clientHeight","PerspectiveCamera","position","set","WebGLRenderer","antialias","alpha","setSize","setPixelRatio","window","devicePixelRatio","outputEncoding","sRGBEncoding","xr","enabled","setupLighting","addEventListener","onResize","ambient","keyLight","fillLight","rimLight","sunLight","skyLight","spotLight","preset","lighting","AmbientLight","add","DirectionalLight","HemisphereLight","SpotLight","OrbitControls","enableDamping","dampingFactor","screenSpacePanning","minDistance","maxDistance","maxPolarAngle","Math","PI","fullscreenBtn","autorotateBtn","arBtn","vrBtn","toggleFullscreen","toggleAutoRotate","setupARButton","setupVRButton","button","navigator","isSessionSupported","startARSession","disabled","title","get_string","startVRSession","loader","gltf","length","GLTFLoader","modelData","reject","load","url","undefined","scale","setScalar","centerCameraOnModel","classList","addPlaceholderModel","console","geometry","BoxGeometry","material","MeshStandardMaterial","color","metalness","roughness","Mesh","box","Box3","setFromObject","center","getCenter","Vector3","size","getSize","maxDim","max","x","y","z","fov","cameraZ","abs","tan","target","copy","update","setAnimationLoop","rotation","render","width","height","updateProjectionMatrix","icon","closest","toggle","querySelector","session","requestSession","requiredFeatures","setSession","trackEvent","optionalFeatures","action","data","call","methodname","args","JSON","stringify"],"mappings":"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"}